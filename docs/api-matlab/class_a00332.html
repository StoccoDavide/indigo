
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Class RKembedded &#8212; indigo v</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/collapsible-lists/css/tree_view.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
    <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Class RKexplicit" href="class_a00336.html" />
    <link rel="prev" title="Class RK4" href="class_a00232.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="class-rkembedded">
<span id="exhale-class-a00332"></span><h1>Class RKembedded<a class="headerlink" href="#class-rkembedded" title="Permalink to this headline">¶</a>
</h1>
<ul class="simple">
<li><p>Defined in <a class="reference internal" href="file_ODE_RKembedded.m.html#file-ode-rkembedded-m"><span class="std std-ref">File RKembedded.m</span></a></p></li>
</ul>
<div class="section" id="inheritance-relationships">
<h2>Inheritance Relationships<a class="headerlink" href="#inheritance-relationships" title="Permalink to this headline">¶</a>
</h2>
<div class="section" id="derived-types">
<h3>Derived Types<a class="headerlink" href="#derived-types" title="Permalink to this headline">¶</a>
</h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">HeunEuler</span></code> (<a class="reference internal" href="class_a00156.html#exhale-class-a00156"><span class="std std-ref">Class HeunEuler</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">Merson45</span></code> (<a class="reference internal" href="class_a00160.html#exhale-class-a00160"><span class="std std-ref">Class Merson45</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">RKF12</span></code> (<a class="reference internal" href="class_a00164.html#exhale-class-a00164"><span class="std std-ref">Class RKF12</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">RKF45I</span></code> (<a class="reference internal" href="class_a00168.html#exhale-class-a00168"><span class="std std-ref">Class RKF45I</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">RKF45II</span></code> (<a class="reference internal" href="class_a00172.html#exhale-class-a00172"><span class="std std-ref">Class RKF45II</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">RKF78</span></code> (<a class="reference internal" href="class_a00176.html#exhale-class-a00176"><span class="std std-ref">Class RKF78</span></a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">Zonnenveld45</span></code> (<a class="reference internal" href="class_a00180.html#exhale-class-a00180"><span class="std std-ref">Class Zonnenveld45</span></a>)</p></li>
</ul>
</div>
</div>
<div class="section" id="class-documentation">
<h2>Class Documentation<a class="headerlink" href="#class-documentation" title="Permalink to this headline">¶</a>
</h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv410RKembedded">
<span id="_CPPv310RKembedded"></span><span id="_CPPv210RKembedded"></span><span id="RKembedded"></span><span class="target" id="a00332"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RKembedded</span></span></span><a class="headerlink" href="#_CPPv410RKembedded" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Class implementing the abstract function step for the embedded Runge-Kutta integration method. The user must simply define the Butcher tableau of the method, which defined as:</p>
<p></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c}
  \mathbf{c} &amp; \mathbf{A} \\ \hline
             &amp; \mathbf{b}
             &amp; \hat{\mathbf{b}}
\end{array}
\end{split}\]</div>

<p>where <span class="math notranslate nohighlight">\( \mathbf{A} \)</span> is the Runge-Kutta matrix (lower triangular matrix):</p>
<p></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{A} = \begin{bmatrix}
  a_{11} &amp; a_{12} &amp; \dots  &amp; a_{1s} \\
  a_{21} &amp; a_{22} &amp; \dots  &amp; a_{2s} \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  a_{s1} &amp; a_{s2} &amp; \dots  &amp; a_{ss}
\end{bmatrix},
\end{split}\]</div>

<p><span class="math notranslate nohighlight">\( \mathbf{b} \)</span> is the Runge-Kutta weights vector relative to a method of order <span class="math notranslate nohighlight">\( p \)</span> (row vector):</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{b} = \left[ b_1, b_2, \dots, b_s \right],\]</div>
 <span class="math notranslate nohighlight">\( \hat{\mathbf{b}} \)</span> is the Runge-Kutta weights vector relative to a method of order <span class="math notranslate nohighlight">\( \hat{p} \)</span> (usually <span class="math notranslate nohighlight">\( \hat{p} = p−1 \)</span> or <span class="math notranslate nohighlight">\( \hat{p}
= p+1 \)</span>) (row vector):
<p></p>
<div class="math notranslate nohighlight">
\[
\hat{\mathbf{b}} = \left[ \hat{b}_1, \hat{b}_2, \dots, \hat{b}_s \right],
\]</div>

<p>and <span class="math notranslate nohighlight">\( \mathbf{c} \)</span> is the Runge-Kutta nodes vector (column vector):</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{c} = \left[ c_1, c_2, \dots, c_s \right]^T.
\]</div>
 
<p>Subclassed by <a class="reference internal" href="class_a00156.html#a00156"><span class="std std-ref">HeunEuler</span></a>, <a class="reference internal" href="class_a00160.html#a00160"><span class="std std-ref">Merson45</span></a>, <a class="reference internal" href="class_a00164.html#a00164"><span class="std std-ref">RKF12</span></a>, <a class="reference internal" href="class_a00168.html#a00168"><span class="std std-ref">RKF45I</span></a>, <a class="reference internal" href="class_a00172.html#a00172"><span class="std std-ref">RKF45II</span></a>, <a class="reference internal" href="class_a00176.html#a00176"><span class="std std-ref">RKF78</span></a>, <a class="reference internal" href="class_a00180.html#a00180"><span class="std std-ref">Zonnenveld45</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded10RKembeddedE2in2in2in2in2in">
<span id="_CPPv3N10RKembedded10RKembeddedE2in2in2in2in2in"></span><span id="_CPPv2N10RKembedded10RKembeddedE2in2in2in2in2in"></span><span id="RKembedded::RKembedded__in.in.in.in.in"></span><span class="target" id="a00332_1a3998460f55a00879d77229a96193a970"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RKembedded</span></span></span><span class="sig-paren">(</span></span><span class="n sig-param"><span class="pre">name</span></span>, </span><span class="n sig-param"><span class="pre">A</span></span>, </span><span class="n sig-param"><span class="pre">b_h</span></span>, </span><span class="n sig-param"><span class="pre">b_l</span></span>, </span><span class="n sig-param"><span class="pre">c</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded10RKembeddedE2in2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Initialize the class with the embedded Runge-Kutta method name and its Butcher tableau.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>name</strong> – Name of the method. </p></li>
<li><p><strong>A</strong> – Matrix (lower triangular matrix). </p></li>
<li><p><strong>b_h</strong> – Low weights vector (row vector). </p></li>
<li><p><strong>b_l</strong> – High weights vector (row vector). </p></li>
<li><p><strong>c</strong> – Nodes vector (column vector). </p></li>
</ul>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded5get_AE2in">
<span id="_CPPv3N10RKembedded5get_AE2in"></span><span id="_CPPv2N10RKembedded5get_AE2in"></span><span id="RKembedded::get_A__in"></span><span class="target" id="a00332_1abe56b8980ae6133dbf8e26fd581ded83"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_A</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded5get_AE2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Get the matrix <span class="math notranslate nohighlight">\( \mathbf{A} \)</span> (lower triangular matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd">
<p>The matrix <span class="math notranslate nohighlight">\( \mathbf{A} \)</span> (lower triangular matrix). </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded5set_AE2in2in">
<span id="_CPPv3N10RKembedded5set_AE2in2in"></span><span id="_CPPv2N10RKembedded5set_AE2in2in"></span><span id="RKembedded::set_A__in.in"></span><span class="target" id="a00332_1a0fb645c17de7eeb6ca914b1cc6df6a92"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_A</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">t_A</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded5set_AE2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Set the matrix <span class="math notranslate nohighlight">\( \mathbf{A} \)</span> (lower triangular matrix).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<p><strong>t_A</strong> – The matrix <span class="math notranslate nohighlight">\( \mathbf{A} \)</span> (lower triangular matrix). </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded7get_b_hE2in">
<span id="_CPPv3N10RKembedded7get_b_hE2in"></span><span id="_CPPv2N10RKembedded7get_b_hE2in"></span><span id="RKembedded::get_b_h__in"></span><span class="target" id="a00332_1a9ebdfcb1d96488e466a8cb71f218f8d9"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_b_h</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded7get_b_hE2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Get the high weights vector <span class="math notranslate nohighlight">\( \mathbf{b} \)</span> (row vector).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd">
<p>The high weights vector <span class="math notranslate nohighlight">\( \mathbf{b} \)</span> (row vector). </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded7set_b_hE2in2in">
<span id="_CPPv3N10RKembedded7set_b_hE2in2in"></span><span id="_CPPv2N10RKembedded7set_b_hE2in2in"></span><span id="RKembedded::set_b_h__in.in"></span><span class="target" id="a00332_1ae74dfe4721ea6d71c05e6ce281aa0db0"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_b_h</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">t_b_h</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded7set_b_hE2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Set the high weights vector <span class="math notranslate nohighlight">\( \mathbf{b} \)</span> (row vector).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<p><strong>t_b_h</strong> – The high weights vector <span class="math notranslate nohighlight">\( \mathbf{b} \)</span> (row vector). </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded7get_b_lE2in">
<span id="_CPPv3N10RKembedded7get_b_lE2in"></span><span id="_CPPv2N10RKembedded7get_b_lE2in"></span><span id="RKembedded::get_b_l__in"></span><span class="target" id="a00332_1a398147a967b2006513a1d35f800cda4d"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_b_l</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded7get_b_lE2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Get the low weights vector <span class="math notranslate nohighlight">\( \hat{\mathbf{b}} \)</span> (row vector).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd">
<p>The low weights vector <span class="math notranslate nohighlight">\( \hat{\mathbf{b}} \)</span> (row vector). </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded7set_b_lE2in2in">
<span id="_CPPv3N10RKembedded7set_b_lE2in2in"></span><span id="_CPPv2N10RKembedded7set_b_lE2in2in"></span><span id="RKembedded::set_b_l__in.in"></span><span class="target" id="a00332_1a3e969576673bbe20ceccb7fb986c5a72"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_b_l</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">t_b_l</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded7set_b_lE2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Set the low weights vector <span class="math notranslate nohighlight">\( \hat{\mathbf{b}} \)</span> (row vector).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<p><strong>t_b_l</strong> – The low weights vector <span class="math notranslate nohighlight">\( \hat{\mathbf{b}} \)</span> (row vector). </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded5get_cE2in">
<span id="_CPPv3N10RKembedded5get_cE2in"></span><span id="_CPPv2N10RKembedded5get_cE2in"></span><span id="RKembedded::get_c__in"></span><span class="target" id="a00332_1aaab523ffda154789ab50f9c57440478a"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_c</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded5get_cE2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Get the nodes vector <span class="math notranslate nohighlight">\( \mathbf{c} \)</span> (column vector).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd">
<p>The nodes vector <span class="math notranslate nohighlight">\( \mathbf{c} \)</span> (column vector). </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded5set_cE2in2in">
<span id="_CPPv3N10RKembedded5set_cE2in2in"></span><span id="_CPPv2N10RKembedded5set_cE2in2in"></span><span id="RKembedded::set_c__in.in"></span><span class="target" id="a00332_1a7bb1747a0c6b983eea86ff15b788a3a8"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_c</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">t_c</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded5set_cE2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Set the nodes vector <span class="math notranslate nohighlight">\( \mathbf{c} \)</span> (column vector).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<p><strong>t_c</strong> – The nodes vector <span class="math notranslate nohighlight">\( \mathbf{c} \)</span> (column vector). </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded11set_tableauE2in2in2in2in2in">
<span id="_CPPv3N10RKembedded11set_tableauE2in2in2in2in2in"></span><span id="_CPPv2N10RKembedded11set_tableauE2in2in2in2in2in"></span><span id="RKembedded::set_tableau__in.in.in.in.in"></span><span class="target" id="a00332_1a9b64ebd1743f300cdf7089320416d28a"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_tableau</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">A</span></span>, </span><span class="n sig-param"><span class="pre">b_h</span></span>, </span><span class="n sig-param"><span class="pre">b_l</span></span>, </span><span class="n sig-param"><span class="pre">c</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded11set_tableauE2in2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Set the Butcher tableau.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>A</strong> – Matrix <span class="math notranslate nohighlight">\( \mathbf{A} \)</span> (lower triangular matrix). </p></li>
<li><p><strong>b_h</strong> – High weights vector <span class="math notranslate nohighlight">\( \mathbf{b} \)</span> (row vector). </p></li>
<li><p><strong>b_l</strong> – Low weights vector <span class="math notranslate nohighlight">\( \hat{\mathbf{b}} \)</span> (row vector). </p></li>
<li><p><strong>c</strong> – Nodes vector <span class="math notranslate nohighlight">\( \mathbf{c} \)</span> (column vector). </p></li>
</ul>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded4stepE2in2in2in2in2in">
<span id="_CPPv3N10RKembedded4stepE2in2in2in2in2in"></span><span id="_CPPv2N10RKembedded4stepE2in2in2in2in2in"></span><span id="RKembedded::step__in.in.in.in.in"></span><span class="target" id="a00332_1a114478ed667ad9cea48c359aa42c754d"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">step</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">x_k</span></span>, </span><span class="n sig-param"><span class="pre">x_dot_k</span></span>, </span><span class="n sig-param"><span class="pre">t_k</span></span>, </span><span class="n sig-param"><span class="pre">d_t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded4stepE2in2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Compute an integration step using the embedded Runge-Kutta method for a system of ODEs of the form <span class="math notranslate nohighlight">\( \mathbf{F}(\mathbf{x}, \mathbf{x}', t) =
\mathbf{0} \)</span>.</p>
<p><strong>Solution Algorithm</strong></p>
<p>Consider a Runge-Kutta method, written for a system of ODEs of the form <span class="math notranslate nohighlight">\( \mathbf{x}' = \mathbf{f}(\mathbf{x}, t) \)</span>:</p>
<p></p>
<div class="math notranslate nohighlight">
\[\begin{split}
 \begin{array}{l}
 \mathbf{K}_i = \mathbf{f} \left(
   \mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{s} a_{ij} \mathbf{K}_j,
   \, t_k + c_i \Delta t
   \right), \qquad i = 1, 2, \ldots, s \\
 \mathbf{x}_{k+1} = \mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^s b_j
 \mathbf{K}_j \, ,
 \end{array}
 \end{split}\]</div>

<p>Beacuse of the nature of the matrix <span class="math notranslate nohighlight">\( \mathbf{A} \)</span> (lower triangular) the <span class="math notranslate nohighlight">\( s\)</span> stages for a generic embedded Runge-Kutta method take the form:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{K}_i = \mathbf{f} \left(
  \mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{i-1} a_{ij}
  \mathbf{K}_j, \, t_k + c_i \Delta t
  \right), \qquad i = 1, 2, \ldots, s.
\]</div>

<p>Then the embedded Runge-Kutta method for an implicit system of ODEs of the form <span class="math notranslate nohighlight">\(\mathbf{F}(\mathbf{x}, \mathbf{x}', t) = \mathbf{0} \)</span> can be written as:</p>
<p></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l}
\mathbf{F}_i \left(
  \mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{i-1} a_{ij}
    \mathbf{K}_j, \, \mathbf{K}_i, \, t_k + c_i \Delta t
\right) = \mathbf{0}, \qquad i = 1, 2, \ldots, s \\
\mathbf{x}_{k+1} = \mathbf{x}_k + \displaystyle\sum_{j=1}^s b_j \mathbf{K}_j.
\end{array}
\end{split}\]</div>

<p>It is important to notice that the system of <span class="math notranslate nohighlight">\( s \)</span> equations <span class="math notranslate nohighlight">\( \mathbf{F}_i \)</span> is a triangular system (which may be non-linear in the <span class="math notranslate nohighlight">\( \mathbf{K}_i \)</span> variables), so it can be solved using forward substitution and the solution of the system is the vector <span class="math notranslate nohighlight">\( \mathbf{K}
\)</span>. Thus, the final system to be solved is the following:</p>
<p></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left\{\begin{array}{l}
\mathbf{F}_1 \left(
  \mathbf{x}_k, \, \mathbf{K}_1, \, t_k + c_1 \Delta t
\right) = \mathbf{0} \\
\mathbf{F}_2 \left(
  \mathbf{x}_k + \Delta t \, a_{21} \mathbf{K}_1, \,
  \mathbf{K}_2, \, t_k + c_2 \Delta t
\right) = \mathbf{0} \\
~~ \vdots \\
\mathbf{F}_s \left(
  \mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{s-1} a_{sj}
  \mathbf{K}_j, \, \mathbf{K}_s, \, t_k + c_s \Delta t
\right) = \mathbf{0}
\end{array}\right.
\end{split}\]</div>

<p>The <span class="math notranslate nohighlight">\( \mathbf{K}_i \)</span> variable are computed using the Newton’s method.</p>
<p><strong>Note</strong></p>
<p>The suggested time step for the next advancing step <span class="math notranslate nohighlight">\( \Delta t_{k+1} \)</span>, is the same as the input time step <span class="math notranslate nohighlight">\( \Delta t \)</span> since in the implicit Runge-Kutta method the time step is not modified through any error control method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>x_k</strong> – States value at <span class="math notranslate nohighlight">\( k \)</span>-th time step <span class="math notranslate nohighlight">\( \mathbf{x}(t_k) \)</span>. </p></li>
<li><p><strong>x_dot_k</strong> – States derivative at <span class="math notranslate nohighlight">\( k \)</span>-th time step <span class="math notranslate nohighlight">\( \mathbf{x}'
               (t_k) \)</span>. </p></li>
<li><p><strong>t_k</strong> – Time step <span class="math notranslate nohighlight">\( t_k \)</span>. </p></li>
<li><p><strong>d_t</strong> – Advancing time step <span class="math notranslate nohighlight">\( \Delta t\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>The approximation of the states at <span class="math notranslate nohighlight">\( k+1 \)</span>-th time step <span class="math notranslate nohighlight">\(
        \mathbf{x_{k+1}}(t_{k}+\Delta t) \)</span>, the approximation of the states derivatives at <span class="math notranslate nohighlight">\( k+1 \)</span>-th time step <span class="math notranslate nohighlight">\( \mathbf{x}'_{k+1}
        (t_{k}+\Delta t) \)</span>, the suggested time step for the next advancing step <span class="math notranslate nohighlight">\( \Delta t_{k+1} \)</span>, and the error control flag. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded26compute_adaptive_time_stepE2in2in2in2in">
<span id="_CPPv3N10RKembedded26compute_adaptive_time_stepE2in2in2in2in"></span><span id="_CPPv2N10RKembedded26compute_adaptive_time_stepE2in2in2in2in"></span><span id="RKembedded::compute_adaptive_time_step__in.in.in.in"></span><span class="target" id="a00332_1a37320421595c804b08d51f6f5e9990aa"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compute_adaptive_time_step</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">x_h</span></span>, </span><span class="n sig-param"><span class="pre">x_l</span></span>, </span><span class="n sig-param"><span class="pre">d_t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded26compute_adaptive_time_stepE2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Compute adaptive time step for the next advancing step according to the error control method. The error control method used is the local truncation error (LTE) method, which is based on the following formula:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\left| \mathbf{x}_{k+1} - \mathbf{x}_{k+1}^{(h)} \right| \leq
\dfrac{C \Delta t^{p+1}}{p+1} \left| \mathbf{x}_{k+1}^{(h)} -
\mathbf{x}_{k+1}^{(l)} \right|
\]</div>

<p>where <span class="math notranslate nohighlight">\( \mathbf{x}_{k+1}^{(h)} \)</span> is the approximation of the states at <span class="math notranslate nohighlight">\( k+1 \)</span>-th time step <span class="math notranslate nohighlight">\( \mathbf{x_{k+1}}(t_{k}+\Delta t) \)</span> with higher order method, <span class="math notranslate nohighlight">\( \mathbf{x}_{k+1}^{(l)} \)</span> is the approximation of the states at <span class="math notranslate nohighlight">\( k+1 \)</span>-th time step <span class="math notranslate nohighlight">\( \mathbf{x_{k+1}}(t_{k}+\Delta
t) \)</span> with lower order method, <span class="math notranslate nohighlight">\( C \)</span> is a constant, and <span class="math notranslate nohighlight">\( p \)</span> is the order of the method.</p>
<p>To compute the suggested time step for the next advancing step <span class="math notranslate nohighlight">\(
\Delta t_{k+1} \)</span>, the following formula is used:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\Delta t_{k+1} = \dfrac{C \Delta t^{p+1}}{p+1} \left| \mathbf{x}_{k+1}^{(h)}
- \mathbf{x}_{k+1}^{(l)} \right|^{-\frac{1}{p+1}}
\]</div>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>x_h</strong> – Approximation of the states at <span class="math notranslate nohighlight">\( k+1 \)</span>-th time step <span class="math notranslate nohighlight">\(
           \mathbf{x_{k+1}}(t_{k}+\Delta t) \)</span> with higher order method. </p></li>
<li><p><strong>x_l</strong> – Approximation of the states at <span class="math notranslate nohighlight">\( k+1 \)</span>-th time step <span class="math notranslate nohighlight">\(
           \mathbf{x_{k+1}}(t_{k}+\Delta t) \)</span> with lower order method. </p></li>
<li><p><strong>d_t</strong> – Advancing time step <span class="math notranslate nohighlight">\( \Delta t\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>The suggested time step for the next advancing step <span class="math notranslate nohighlight">\( \Delta
        t_{k+1} \)</span>. </p>
</dd>
</dl>
</dd>
</dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N10RKembedded13check_tableauE2in2in2in2in">
<span id="_CPPv3N10RKembedded13check_tableauE2in2in2in2in"></span><span id="_CPPv2N10RKembedded13check_tableauE2in2in2in2in"></span><span id="RKembedded::check_tableau__in.in.in.in"></span><span class="target" id="a00332_1a59e954f4deb54de31caf01805739da9a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">check_tableau</span></span></span><span class="sig-paren">(</span></span><span class="n sig-param"><span class="pre">A</span></span>, </span><span class="n sig-param"><span class="pre">b_h</span></span>, </span><span class="n sig-param"><span class="pre">b_l</span></span>, </span><span class="n sig-param"><span class="pre">c</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N10RKembedded13check_tableauE2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Check Butcher tableau consistency for an embedded Runge-Kutta method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>A</strong> – Matrix <span class="math notranslate nohighlight">\( \mathbf{A} \)</span>. </p></li>
<li><p><strong>b_h</strong> – High weights vector <span class="math notranslate nohighlight">\( \mathbf{b} \)</span>. </p></li>
<li><p><strong>b_l</strong> – Low weights vector <span class="math notranslate nohighlight">\( \hat{\mathbf{b}} \)</span>. </p></li>
<li><p><strong>c</strong> – Nodes vector <span class="math notranslate nohighlight">\( \mathbf{c} \)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>True if the Butcher tableau is consistent, false otherwise. </p>
</dd>
</dl>
</dd>
</dl>

</div>
</dd>
</dl>

</div>
</div>



          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.jpeg" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Manual_MATLAB.html">MATLAB Toolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="root.html">MATLAB API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Manual_MAPLE.html">MAPLE Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Manual_MAPLE_API.html">MAPLE API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Manual_EXAMPLES.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, D. Stocco, S. Taddei and E. Bertolazzi.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>