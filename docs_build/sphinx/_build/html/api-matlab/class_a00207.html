
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Class Explicit &#8212; indigo v0.3
</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/collapsible-lists/css/tree_view.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
    <script src="../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Class Implicit" href="class_a00211.html" />
    <link rel="prev" title="Class BogackiShampine23" href="class_a00203.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="class-explicit">
<span id="exhale-class-a00207"></span><h1>Class Explicit<a class="headerlink" href="#class-explicit" title="Permalink to this headline">¶</a>
</h1>
<ul class="simple">
<li><p>Defined in <a class="reference internal" href="file_%2BIndigo_%2BRungeKutta_Explicit.m.html#file-indigo-rungekutta-explicit-m"><span class="std std-ref">File Explicit.m</span></a></p></li>
</ul>
<div class="section" id="inheritance-relationships">
<h2>Inheritance Relationships<a class="headerlink" href="#inheritance-relationships" title="Permalink to this headline">¶</a>
</h2>
<div class="section" id="base-types">
<h3>Base Types<a class="headerlink" href="#base-types" title="Permalink to this headline">¶</a>
</h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">Indigo::RungeKutta::Method</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">public</span> <span class="pre">Indigo::Systems::System</span></code></p></li>
</ul>
</div>
</div>
<div class="section" id="class-documentation">
<h2>Class Documentation<a class="headerlink" href="#class-documentation" title="Permalink to this headline">¶</a>
</h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv48Explicit">
<span id="_CPPv38Explicit"></span><span id="_CPPv28Explicit"></span><span id="Explicit"></span><span class="target" id="a00207"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Explicit</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">Indigo</span></span><span class="p">.</span><span class="n"><span class="pre">RungeKutta</span></span><span class="p">.</span><span class="n"><span class="pre">Method</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">Indigo</span></span><span class="p">.</span><span class="n"><span class="pre">Systems</span></span><span class="p">.</span><span class="n"><span class="pre">System</span></span><a class="headerlink" href="#_CPPv48Explicit" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Class implementing the abstract function step for the explicit Runge-Kutta integration method. The user must simply define the Butcher tableau of the method, which defined as:</p>
<p></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{c|c}
  \mathbf{c} &amp; \mathbf{A} \\ \hline
             &amp; \mathbf{b} \\
             &amp; \hat{\mathbf{b}}
\end{array}
\end{split}\]</div>

<p>where <span class="math notranslate nohighlight">\( \mathbf{A} \)</span> is the Runge-Kutta matrix (lower triangular matrix):</p>
<p></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{A} = \begin{bmatrix}
  a_{11} &amp; a_{12} &amp; \dots  &amp; a_{1s} \\
  a_{21} &amp; a_{22} &amp; \dots  &amp; a_{2s} \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  a_{s1} &amp; a_{s2} &amp; \dots  &amp; a_{ss}
\end{bmatrix},
\end{split}\]</div>

<p><span class="math notranslate nohighlight">\( \mathbf{b} \)</span> is the Runge-Kutta weights vector relative to a method of order <span class="math notranslate nohighlight">\( p \)</span> (row vector):</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{b} = \left[ b_1, b_2, \dots, b_s \right],
\]</div>

<p><span class="math notranslate nohighlight">\( \hat{\mathbf{b}} \)</span> is the (optional) embedded Runge-Kutta weights vector relative to a method of order <span class="math notranslate nohighlight">\( \hat{p} \)</span> (usually <span class="math notranslate nohighlight">\( \hat{p} =
p−1 \)</span> or <span class="math notranslate nohighlight">\( \hat{p} = p+1 \)</span>) (row vector):</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\hat{\mathbf{b}} = \left[ \hat{b}_1, \hat{b}_2, \dots, \hat{b}_s \right],
\]</div>

<p>and <span class="math notranslate nohighlight">\( \mathbf{c} \)</span> is the Runge-Kutta nodes vector (column vector):</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{c} = \left[ c_1, c_2, \dots, c_s \right]^T.
\]</div>

<p>Class container for an explicit system of ODEs of the form:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{x}' = \mathbf{f}( \mathbf{x}, \mathbf{v}, t ) =
\mathbf{A}( \mathbf{x}, \mathbf{v}, t )^{-1}
\mathbf{b}( \mathbf{x}, \mathbf{v}, t )
\]</div>

<p>or equivalently:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{F}( \mathbf{x}, \mathbf{x}', \mathbf{v}, t ) =
\mathbf{x}' - \mathbf{f}( \mathbf{x}, \mathbf{v}, t ) = \mathbf{0}
\]</div>

<p>with <em>optional</em> veils <span class="math notranslate nohighlight">\( \mathbf{v}( \mathbf{x}, t ) \)</span> of the form:</p>
<p></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{v}( \mathbf{x}, \mathbf{v}, t ) = \left{\begin{array}{c}
  v_1( \mathbf{x}, t ) \\
  v_2( \mathbf{x}, v_1, t ) \\
  v_3( \mathbf{x}, v_1, v_2, t ) \\
  \vdots \\
  v_n( \mathbf{x}, v_1, \dots, v_{n-1}, t )
\end{array}\right.
\end{split}\]</div>

<p>with <em>optional</em> veils <span class="math notranslate nohighlight">\( \mathbf{v}( \mathbf{x}, t ) \)</span> of the form:</p>
<p></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{v}( \mathbf{x}, \mathbf{v}, t ) = \left{\begin{array}{c}
  v_1( \mathbf{x}, t ) \\
  v_2( \mathbf{x}, v_1, t ) \\
  v_3( \mathbf{x}, v_1, v_2, t ) \\
  \vdots \\
  v_n( \mathbf{x}, v_1, \dots, v_{n-1}, t )
\end{array}\right.
\end{split}\]</div>

<p>And <em>optional</em> invariants of the form:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{h}( \mathbf{x}, \mathbf{v}, t ) = \mathbf{0}
\]</div>

<p>where <span class="math notranslate nohighlight">\( \mathbf{x} \)</span> are the unknown functions (states) of the independent variable <span class="math notranslate nohighlight">\( t \)</span>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit8ExplicitE2in2in2in">
<span id="_CPPv3N8Explicit8ExplicitE2in2in2in"></span><span id="_CPPv2N8Explicit8ExplicitE2in2in2in"></span><span id="Explicit::Explicit__in.in.in"></span><span class="target" id="a00207_1a8689bdc390f929b3c94bc5f22ba8db1a"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Explicit</span></span></span><span class="sig-paren">(</span></span><span class="n sig-param"><span class="pre">name</span></span>, </span><span class="n sig-param"><span class="pre">order</span></span>, </span><span class="n sig-param"><span class="pre">tbl</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit8ExplicitE2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Initialize the class with the explicit Runge-Kutta method name and its Butcher tableau.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>name</strong> – The name of the solver. </p></li>
<li><p><strong>order</strong> – The order of the solver. </p></li>
<li><p><strong>tbl.A</strong> – The matrix <span class="math notranslate nohighlight">\( \mathbf{A} \)</span> (lower triangular matrix). </p></li>
<li><p><strong>tbl.b</strong> – The weights vector <span class="math notranslate nohighlight">\( \mathbf{b} \)</span> (row vector). </p></li>
<li><p><strong>tbl.b_e</strong> – [optional] The embedded weights vector <span class="math notranslate nohighlight">\( \hat{\mathbf{b}}
              \)</span> (row vector). </p></li>
<li><p><strong>tbl.c</strong> – The nodes vector <span class="math notranslate nohighlight">\( \mathbf{c} \)</span> (column vector).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>The instance of the class. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit9step_nodeE2in2in2in2in2in">
<span id="_CPPv3N8Explicit9step_nodeE2in2in2in2in2in"></span><span id="_CPPv2N8Explicit9step_nodeE2in2in2in2in2in"></span><span id="Explicit::step_node__in.in.in.in.in"></span><span class="target" id="a00207_1a4255905817618494cf60a58d4f16ae0e"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">step_node</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">i</span></span>, </span><span class="n sig-param"><span class="pre">x_k</span></span>, </span><span class="n sig-param"><span class="pre">K</span></span>, </span><span class="n sig-param"><span class="pre">d_t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit9step_nodeE2in2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Compute the node as:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{x}_i = \mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{i-1}
  a_{ij} \mathbf{K}_j.
\]</div>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>i</strong> – Index of the node to be computed. </p></li>
<li><p><strong>x_k</strong> – States value at <span class="math notranslate nohighlight">\( k \)</span>-th time step <span class="math notranslate nohighlight">\( \mathbf{x}(t_k) \)</span>. </p></li>
<li><p><strong>K</strong> – Variable <span class="math notranslate nohighlight">\( \mathbf{K} \)</span> of the system to be solved. </p></li>
<li><p><strong>d_t</strong> – Advancing time step <span class="math notranslate nohighlight">\( \Delta t\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>The residual of the ODEs system to be solved. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit13step_residualE2in2in2in2in2in2in">
<span id="_CPPv3N8Explicit13step_residualE2in2in2in2in2in2in"></span><span id="_CPPv2N8Explicit13step_residualE2in2in2in2in2in2in"></span><span id="Explicit::step_residual__in.in.in.in.in.in"></span><span class="target" id="a00207_1a695725dfd58ac02ad244f0736adc1383"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">step_residual</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">i</span></span>, </span><span class="n sig-param"><span class="pre">x_i</span></span>, </span><span class="n sig-param"><span class="pre">K</span></span>, </span><span class="n sig-param"><span class="pre">v_i</span></span>, </span><span class="n sig-param"><span class="pre">t_i</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit13step_residualE2in2in2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Compute the left hand side of the ODEs system to be solved:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{F}_i\left(\mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{i-1}
  a_{ij} \mathbf{K}_j, \, \mathbf{K}_i, \, t_k + c_i \Delta t
\right) = \mathbf{0}.
\]</div>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>i</strong> – Index of the step to be computed. </p></li>
<li><p><strong>x_i</strong> – States value at <span class="math notranslate nohighlight">\( i \)</span>-th node. </p></li>
<li><p><strong>K</strong> – Variable <span class="math notranslate nohighlight">\( \mathbf{K} \)</span> of the system to be solved. </p></li>
<li><p><strong>v_i</strong> – Veils <span class="math notranslate nohighlight">\( \mathbf{v}_i \)</span> at <span class="math notranslate nohighlight">\( i \)</span>-th node. </p></li>
<li><p><strong>t_i</strong> – Time step <span class="math notranslate nohighlight">\( t_i \)</span> at <span class="math notranslate nohighlight">\( i \)</span>-th node.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>The residual of the ODEs system to be solved. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit13step_jacobianE2in2in2in2in2in2in">
<span id="_CPPv3N8Explicit13step_jacobianE2in2in2in2in2in2in"></span><span id="_CPPv2N8Explicit13step_jacobianE2in2in2in2in2in2in"></span><span id="Explicit::step_jacobian__in.in.in.in.in.in"></span><span class="target" id="a00207_1a11b884a252b19390aa6088bee9c98a3b"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">step_jacobian</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">i</span></span>, </span><span class="n sig-param"><span class="pre">x_i</span></span>, </span><span class="n sig-param"><span class="pre">K</span></span>, </span><span class="n sig-param"><span class="pre">v_i</span></span>, </span><span class="n sig-param"><span class="pre">t_i</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit13step_jacobianE2in2in2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Compute the Jacobian of the ODEs system of equations:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{F}_i\left(\mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{i-1}
  a_{ij} \mathbf{K}_j, \, \mathbf{K}_i, \, t_k + c_i \Delta t
\right) = \mathbf{0}
\]</div>

<p>to be solved in the <span class="math notranslate nohighlight">\( \mathbf{K} \)</span> variable:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\dfrac{\partial \mathbf{F}_i}{\partial \mathbf{K}_i} \left(
  \mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{i-1} a_{ij} \mathbf{K}_j,
  \, \mathbf{K}_i, \, t_k + c_i \Delta t
\right)
\]</div>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>i</strong> – Index of the step to be computed. </p></li>
<li><p><strong>x_i</strong> – <span class="math notranslate nohighlight">\( i \)</span>-th node. </p></li>
<li><p><strong>K</strong> – Variable <span class="math notranslate nohighlight">\( \mathbf{K} \)</span> of the system to be solved. </p></li>
<li><p><strong>v_i</strong> – Veils <span class="math notranslate nohighlight">\( \mathbf{v}_i \)</span> at <span class="math notranslate nohighlight">\( i \)</span>-th node. </p></li>
<li><p><strong>t_i</strong> – Time step <span class="math notranslate nohighlight">\( t_i \)</span> at <span class="math notranslate nohighlight">\( i \)</span>-th node.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>The Jacobian of the ODEs system of equations to be solved. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit10solve_stepE2in2in2in2in2in">
<span id="_CPPv3N8Explicit10solve_stepE2in2in2in2in2in"></span><span id="_CPPv2N8Explicit10solve_stepE2in2in2in2in2in"></span><span id="Explicit::solve_step__in.in.in.in.in"></span><span class="target" id="a00207_1a6c01209fafdb8886d0becee68e0f60d9"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">solve_step</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">x_k</span></span>, </span><span class="n sig-param"><span class="pre">K_0</span></span>, </span><span class="n sig-param"><span class="pre">t_k</span></span>, </span><span class="n sig-param"><span class="pre">d_t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit10solve_stepE2in2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Solve the <span class="math notranslate nohighlight">\( i \)</span>-th explicit step of the ODEs system to find the <span class="math notranslate nohighlight">\( \mathbf{K}_i \)</span> variable:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{F}_i\left(\mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{i-1}
  a_{ij} \mathbf{K}_j, \, \mathbf{K}_i, \, t_k + c_i \Delta t
\right) = \mathbf{0}
\]</div>

<p>by Newton’s method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>x_k</strong> – States value at <span class="math notranslate nohighlight">\( k \)</span>-th time step <span class="math notranslate nohighlight">\( \mathbf{x}(t_k) \)</span>. </p></li>
<li><p><strong>K</strong> – Initial guess for the <span class="math notranslate nohighlight">\( \mathbf{K} \)</span> variable to be found. </p></li>
<li><p><strong>t_k</strong> – Time step <span class="math notranslate nohighlight">\( t_k \)</span>. </p></li>
<li><p><strong>d_t</strong> – Advancing time step <span class="math notranslate nohighlight">\( \Delta t\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>The <span class="math notranslate nohighlight">\( \mathbf{K} \)</span> variables of the ODEs system to be solved and the error control flag. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit4stepE2in2in2in2in2in">
<span id="_CPPv3N8Explicit4stepE2in2in2in2in2in"></span><span id="_CPPv2N8Explicit4stepE2in2in2in2in2in"></span><span id="Explicit::step__in.in.in.in.in"></span><span class="target" id="a00207_1a8d99d99728f6ba61f8370445c2cd7138"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">step</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">x_k</span></span>, </span><span class="n sig-param"><span class="pre">x_dot_k</span></span>, </span><span class="n sig-param"><span class="pre">t_k</span></span>, </span><span class="n sig-param"><span class="pre">d_t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit4stepE2in2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Compute an integration step using the explicit Runge-Kutta method for a system of ODEs of the form <span class="math notranslate nohighlight">\( \mathbf{F}(\mathbf{x}, \mathbf{x}',
\mathbf{v}, t) = \mathbf{0} \)</span>.</p>
<p><strong>Solution Algorithm</strong></p>
<p>Consider a Runge-Kutta method, written for a system of ODEs of the form <span class="math notranslate nohighlight">\( \mathbf{x}' = \mathbf{f}(\mathbf{x}, \mathbf{v}, t) \)</span>:</p>
<p></p>
<div class="math notranslate nohighlight">
\[\begin{split}
 \begin{array}{l}
 \mathbf{K}_i = \mathbf{f} \left(
   \mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{s} a_{ij} \mathbf{K}_j,
   \, t_k + c_i \Delta t
   \right), \qquad i = 1, 2, \ldots, s \\
 \mathbf{x}_{k+1} = \mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^s b_j
 \mathbf{K}_j \, ,
 \end{array}
 \end{split}\]</div>

<p>Beacuse of the nature of the matrix <span class="math notranslate nohighlight">\( \mathbf{A} \)</span> (lower triangular) the <span class="math notranslate nohighlight">\( s\)</span> stages for a generic explicit Runge-Kutta method take the form:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{K}_i = \mathbf{f} \left(
  \mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{i-1} a_{ij}
  \mathbf{K}_j, \, t_k + c_i \Delta t
  \right), \qquad i = 1, 2, \ldots, s.
\]</div>

<p>Then the explicit Runge-Kutta method for an implicit system of ODEs of the form <span class="math notranslate nohighlight">\(\mathbf{F}(\mathbf{x}, \mathbf{x}', t) = \mathbf{0} \)</span> can be written as:</p>
<p></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{l}
\mathbf{F}_i \left(
  \mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{i-1} a_{ij}
    \mathbf{K}_j, \, \mathbf{K}_i, \, t_k + c_i \Delta t
\right) = \mathbf{0}, \qquad i = 1, 2, \ldots, s \\
\mathbf{x}_{k+1} = \mathbf{x}_k + \displaystyle\sum_{j=1}^s b_j \mathbf{K}_j.
\end{array}
\end{split}\]</div>

<p>It is important to notice that the system of <span class="math notranslate nohighlight">\( s \)</span> equations <span class="math notranslate nohighlight">\( \mathbf{F}_i \)</span> is a triangular system (which may be non-linear in the <span class="math notranslate nohighlight">\( \mathbf{K}_i \)</span> variables), so it can be solved using forward substitution and the solution of the system is the vector <span class="math notranslate nohighlight">\( \mathbf{K}
\)</span>. Thus, the final system to be solved is the following:</p>
<p></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left\{\begin{array}{l}
\mathbf{F}_1 \left(
  \mathbf{x}_k, \, \mathbf{K}_1, \, t_k + c_1 \Delta t
\right) = \mathbf{0} \\
\mathbf{F}_2 \left(
  \mathbf{x}_k + \Delta t \, a_{21} \mathbf{K}_1, \,
  \mathbf{K}_2, \, t_k + c_2 \Delta t
\right) = \mathbf{0} \\
~~ \vdots \\
\mathbf{F}_s \left(
  \mathbf{x}_k + \Delta t \displaystyle\sum_{j=1}^{s-1} a_{sj}
  \mathbf{K}_j, \, \mathbf{K}_s, \, t_k + c_s \Delta t
\right) = \mathbf{0}
\end{array}\right.
\end{split}\]</div>

<p>The <span class="math notranslate nohighlight">\( \mathbf{K}_i \)</span> variable are computed using the Newton’s method.</p>
<p><strong>Note</strong></p>
<p>Another approach is to directly solve the whole system of equations by Newton’smethod. In other words, the system of equations is solved iteratively by computing the Jacobian matrixes of the system and using them to compute the solution. This approach is used in the implicit Runge-Kutta method. For this reason, a Butcher tableau relative to an explicit Runge-Kutta method can also be used in the <code class="docutils literal notranslate"><span class="pre">ImplicitRungeKutta</span></code> class.</p>
<p>The suggested time step for the next advancing step <span class="math notranslate nohighlight">\( \Delta t_{k+1} \)</span>, is the same as the input time step <span class="math notranslate nohighlight">\( \Delta t \)</span> since in the explicit Runge-Kutta method the time step is not modified through any error control method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>x_k</strong> – States value at <span class="math notranslate nohighlight">\( k \)</span>-th time step <span class="math notranslate nohighlight">\( \mathbf{x}(t_k) \)</span>. </p></li>
<li><p><strong>x_dot_k</strong> – States derivative at <span class="math notranslate nohighlight">\( k \)</span>-th time step <span class="math notranslate nohighlight">\( \mathbf{x}'
               (t_k) \)</span>. </p></li>
<li><p><strong>t_k</strong> – Time step <span class="math notranslate nohighlight">\( t_k \)</span>. </p></li>
<li><p><strong>d_t</strong> – Advancing time step <span class="math notranslate nohighlight">\( \Delta t\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>The approximation of the states at <span class="math notranslate nohighlight">\( k+1 \)</span>-th time step <span class="math notranslate nohighlight">\(
        \mathbf{x_{k+1}}(t_{k}+\Delta t) \)</span>, the approximation of the states derivatives at <span class="math notranslate nohighlight">\( k+1 \)</span>-th time step <span class="math notranslate nohighlight">\( \mathbf{x}'_{k+1}
        (t_{k}+\Delta t) \)</span>, the suggested time step for the next advancing step <span class="math notranslate nohighlight">\( \Delta t_{k+1} \)</span>, and the error control flag. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit8ExplicitE2in2in2in2in">
<span id="_CPPv3N8Explicit8ExplicitE2in2in2in2in"></span><span id="_CPPv2N8Explicit8ExplicitE2in2in2in2in"></span><span id="Explicit::Explicit__in.in.in.in"></span><span class="target" id="a00207_1a0f6d094260fafb853b8b294f35f98abc"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Explicit</span></span></span><span class="sig-paren">(</span></span><span class="n sig-param"><span class="pre">t_name</span></span>, </span><span class="n sig-param"><span class="pre">t_neqn</span></span>, </span><span class="n sig-param"><span class="pre">t_veil</span></span>, </span><span class="n sig-param"><span class="pre">t_ninv</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit8ExplicitE2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Class constructor for a explicit system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>t_name</strong> – Name of the system. </p></li>
<li><p><strong>t_neqn</strong> – Number of equations of the system. </p></li>
<li><p><strong>t_veil</strong> – Number of veils of the system. </p></li>
<li><p><strong>t_ninv</strong> – Number of invariants of the system. </p></li>
</ul>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit1FE2in2in2in2in2in">
<span id="_CPPv3N8Explicit1FE2in2in2in2in2in"></span><span id="_CPPv2N8Explicit1FE2in2in2in2in2in"></span><span id="Explicit::F__in.in.in.in.in"></span><span class="target" id="a00207_1a329132c0a047850193a1088b206dd225"></span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">F</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">x</span></span>, </span><span class="n sig-param"><span class="pre">v</span></span>, </span><span class="n sig-param"><span class="pre">x_dot</span></span>, </span><span class="n sig-param"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit1FE2in2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd></dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit1fE2in2in2in2in">
<span id="_CPPv3N8Explicit1fE2in2in2in2in"></span><span id="_CPPv2N8Explicit1fE2in2in2in2in"></span><span id="Explicit::f__in.in.in.in"></span><span class="target" id="a00207_1a1b16a45e8b129282cc33163df4264631"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">f</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">x</span></span>, </span><span class="n sig-param"><span class="pre">v</span></span>, </span><span class="n sig-param"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit1fE2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Evaluate the system function <span class="math notranslate nohighlight">\( \mathbf{f} \)</span>:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{f}( \mathbf{x}, \mathbf{v}, t ) = \mathbf{0}.
\]</div>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>x</strong> – States <span class="math notranslate nohighlight">\( \mathbf{x} \)</span>. </p></li>
<li><p><strong>v</strong> – Veils <span class="math notranslate nohighlight">\( \mathbf{v} \)</span>. </p></li>
<li><p><strong>t</strong> – Independent variable <span class="math notranslate nohighlight">\( t \)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>The function <span class="math notranslate nohighlight">\( \mathbf{f} \)</span>. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit4Jf_xE2in2in2in2in">
<span id="_CPPv3N8Explicit4Jf_xE2in2in2in2in"></span><span id="_CPPv2N8Explicit4Jf_xE2in2in2in2in"></span><span id="Explicit::Jf_x__in.in.in.in"></span><span class="target" id="a00207_1ac5bd2ae8bad394d227664c2182c8e3d8"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Jf_x</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">x</span></span>, </span><span class="n sig-param"><span class="pre">v</span></span>, </span><span class="n sig-param"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit4Jf_xE2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Evaluate the Jacobian of the system function <span class="math notranslate nohighlight">\( \mathbf{f} \)</span> with respect to the states <span class="math notranslate nohighlight">\( \mathbf{x} \)</span>:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{Jf}_{\mathbf{x}}( \mathbf{x}, \mathbf{v}, t ) =
\dfrac{
  \partial \mathbf{f}( \mathbf{x}, \mathbf{v}, t )
}{
  \partial \mathbf{x}
}.
\]</div>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>x</strong> – States <span class="math notranslate nohighlight">\( \mathbf{x} \)</span>. </p></li>
<li><p><strong>v</strong> – Veils <span class="math notranslate nohighlight">\( \mathbf{v} \)</span>. </p></li>
<li><p><strong>t</strong> – Independent variable <span class="math notranslate nohighlight">\( t \)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>The Jacobian <span class="math notranslate nohighlight">\( \mathbf{Jf}_{\mathbf{x}} \)</span>. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit4Jf_vE2in2in2in2in2in">
<span id="_CPPv3N8Explicit4Jf_vE2in2in2in2in2in"></span><span id="_CPPv2N8Explicit4Jf_vE2in2in2in2in2in"></span><span id="Explicit::Jf_v__in.in.in.in.in"></span><span class="target" id="a00207_1a289f19fc4d041efb20b24bb143145426"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Jf_v</span></span></span><span class="sig-paren">(</span><span class="n"></span><span class="n sig-param"><span class="pre">x</span></span>, </span><span class="n sig-param"><span class="pre">x_dot</span></span>, </span><span class="n sig-param"><span class="pre">v</span></span>, </span><span class="n sig-param"><span class="pre">t</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit4Jf_vE2in2in2in2in2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Evaluate the Jacobian of the system function <span class="math notranslate nohighlight">\( \mathbf{f} \)</span> with respect to the veils <span class="math notranslate nohighlight">\( \mathbf{v} \)</span>:</p>
<p></p>
<div class="math notranslate nohighlight">
\[
\mathbf{Jf}_{\mathbf{v}}( \mathbf{x}, \mathbf{x}', \mathbf{v}, t ) =
\dfrac{
  \partial \mathbf{f}( \mathbf{x}, \mathbf{x}', \mathbf{v}, t )
}{
  \partial \mathbf{v}
}
\]</div>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>x</strong> – States <span class="math notranslate nohighlight">\( \mathbf{x} \)</span>. </p></li>
<li><p><strong>x_dot</strong> – States derivatives <span class="math notranslate nohighlight">\( \mathbf{x}' \)</span>. </p></li>
<li><p><strong>v</strong> – Veils <span class="math notranslate nohighlight">\( \mathbf{v} \)</span>. </p></li>
<li><p><strong>t</strong> – Independent variable <span class="math notranslate nohighlight">\( t \)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>The Jacobian <span class="math notranslate nohighlight">\( \mathbf{Jf}_{\mathbf{v}} \)</span>. </p>
</dd>
</dl>
</dd>
</dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit13check_tableauE2in">
<span id="_CPPv3N8Explicit13check_tableauE2in"></span><span id="_CPPv2N8Explicit13check_tableauE2in"></span><span id="Explicit::check_tableau__in"></span><span class="target" id="a00207_1a056ad98be4bff98c6e6530aa4e103173"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">check_tableau</span></span></span><span class="sig-paren">(</span></span><span class="n sig-param"><span class="pre">tbl</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit13check_tableauE2in" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Check Butcher tableau consistency for an explicit Runge-Kutta method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd">
<ul class="simple">
<li><p><strong>tbl.A</strong> – Matrix <span class="math notranslate nohighlight">\( \mathbf{A} \)</span>. </p></li>
<li><p><strong>tbl.b</strong> – Weights vector <span class="math notranslate nohighlight">\( \mathbf{b} \)</span>. </p></li>
<li><p><strong>tbl.b_e</strong> – [optional] Embedded weights vector <span class="math notranslate nohighlight">\( \hat{\mathbf{b}} \)</span>. </p></li>
<li><p><strong>tbl.c</strong> – Nodes vector <span class="math notranslate nohighlight">\( \mathbf{c} \)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even">
<p>True if the Butcher tableau is consistent, false otherwise. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit8whattypeEv">
<span id="_CPPv3N8Explicit8whattypeEv"></span><span id="_CPPv2N8Explicit8whattypeEv"></span><span id="Explicit::whattype"></span><span class="target" id="a00207_1aad348e7d04cd08adb7848fb79d258611"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">whattype</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit8whattypeEv" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Get the system type.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd">
<p>The system type. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit11is_explicitEv">
<span id="_CPPv3N8Explicit11is_explicitEv"></span><span id="_CPPv2N8Explicit11is_explicitEv"></span><span id="Explicit::is_explicit"></span><span class="target" id="a00207_1ae94b237e0a7f4dcf2c8ddeeb61e146dc"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_explicit</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit11is_explicitEv" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Check if the system is explicit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd">
<p>True if the system is explicit, false otherwise. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit15is_semiexplicitEv">
<span id="_CPPv3N8Explicit15is_semiexplicitEv"></span><span id="_CPPv2N8Explicit15is_semiexplicitEv"></span><span id="Explicit::is_semiexplicit"></span><span class="target" id="a00207_1a380cf5c9f5dc0d676149e11511d28cfd"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_semiexplicit</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit15is_semiexplicitEv" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Check if the system is semiexplicit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd">
<p>True if the system is semiexplicit, false otherwise. </p>
</dd>
</dl>
</dd>
</dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N8Explicit11is_implicitEv">
<span id="_CPPv3N8Explicit11is_implicitEv"></span><span id="_CPPv2N8Explicit11is_implicitEv"></span><span id="Explicit::is_implicit"></span><span class="target" id="a00207_1ac5815e0d6a38b1227f790936b1f7061a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">function</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_implicit</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N8Explicit11is_implicitEv" title="Permalink to this definition">¶</a><br>
</dt>
<dd>
<p>Check if the system is implicit.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd">
<p>True if the system is implicit, false otherwise. </p>
</dd>
</dl>
</dd>
</dl>

</div>
</dd>
</dl>

</div>
</div>



          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
<h3><a href="../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Manual_MATLAB_Toolbox.html">MATLAB Toolbox</a></li>
<li class="toctree-l1"><a class="reference internal" href="root.html">MATLAB API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Manual_MAPLE_Package.html">MAPLE Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Manual_MAPLE_API.html">MAPLE API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Manual_Examples_Index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Manual_References.html">References</a></li>
</ul>

        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, D. Stocco, S. Taddei and E. Bertolazzi.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>